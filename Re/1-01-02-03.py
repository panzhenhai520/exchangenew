# We'll generate three bilingual Word documents (.docx). If python-docx is unavailable,
# we'll fall back to simple .rtf files that open in Word. The layout is a two-column
# Thai (left) vs. Chinese (right) table, section-by-section, mirroring the original forms.
#
# Files created:
#  - /mnt/data/AML-1-01-bilingual.docx (or .rtf fallback)
#  - /mnt/data/AML-1-02-bilingual.docx (or .rtf fallback)
#  - /mnt/data/AML-1-03-bilingual.docx (or .rtf fallback)
#
# NOTE: Internet is disabled; we avoid external dependencies beyond what's available.

import os, sys, textwrap, json

def build_sections_1_01():
    th_title = "แบบรายงานการทําธุรกรรมที่ใช้เงินสด (แบบ ปปง. ๑-๐๑)"
    zh_title = "现金交易报告表（表格编号：ปปง. 1-01）"
    sections = [
        ("ข้อมูลส่วนหัว / Header",
         [
            ("รายงานฉบับหลัก / รายงานฉบับแก้ไข/เพิ่มเติม ครั้งที่___ ลงวันที่___",
             "主报告 / 更正/补充报告 第___次，日期___"),
            ("เลขที่ ________  สถาบันการเงิน ________  สาขา ________  พ.ศ. ________  เลขลําดับรายงาน (ใช้ 2 หลักสุดท้าย) ________",
             "编号______  金融机构______  网点______  佛历年份______  报告顺序号（取后2位）______"),
            ("รวมเอกสารจํานวนทั้งสิ้น ______ แผ่น",
             "附件总计 ______ 页"),
         ]),
        ("ส่วนที่ ๑. ผู้ทําธุรกรรม",
         [
            ("๑.๑ ชื่อ-นามสกุล；ทําธุรกรรมด้วยตนเอง / ทําธุรกรรมแทนผู้อื่น (รายละเอียดโปรดกรอกในส่วนที่ ๒)",
             "1.1 姓名；自行办理 / 代他人办理（详情请填写第2部分）"),
            ("๑.๒ ที่อยู่；โทรศัพท์；โทรสาร",
             "1.2 地址；电话；传真"),
            ("๑.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์",
             "1.3 职业；工作单位；电话"),
            ("๑.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "1.4 方便联系地址；电话；传真"),
            ("๑.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、อื่นๆ（โปรดระบุ）。เลขที่、ออกโดย、เมื่อ、หมดอายุ",
             "1.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、其他（请注明）。编号、签发机关、签发日期、到期日"),
            ("โปรดระบุเลขที่บัตรประจําตัวประชาชน / หากเป็นนิติบุคคล โปรดระบุเลขประจําตัวผู้เสียภาษีอากร / หากเป็นคนต่างด้าว โปรดระบุเลขที่หนังสือเดินทาง หรือเอกสารประจําตัวอื่นๆ",
             "请填写身份证号 / 如为法人请填纳税人识别号 / 如为外籍请填护照号或其他身份证件号"),
         ]),
        ("ส่วนที่ ๒. ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
         [
            ("โปรดระบุฐานะ: ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
             "请选择身份：共同交易人 / 委托人 / 授权人"),
            ("๒.๑ ชื่อ",
             "2.1 姓名 / 名称"),
            ("๒.๒ ที่อยู่/สถานที่ตั้ง；โทรศัพท์；โทรสาร",
             "2.2 地址/所在地；电话；传真"),
            ("๒.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์ (กรณีเป็นนิติบุคคล ระบุประเภทกิจการ)",
             "2.3 职业；工作单位；电话（如为法人，请注明经营类型）"),
            ("๒.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "2.4 方便联系地址；电话；传真"),
            ("๒.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、หนังสือรับรองทะเบียน (ไม่เกิน 1 เดือน)、อื่นๆ（โปรดระบุ）。เลขที่、ออกโดย、เมื่อ、หมดอายุ",
             "2.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、登记信息证明（登记官出具，日期不超过1个月）、其他（请注明）。编号、签发机关、签发日期、到期日"),
            ("โปรดระบุเลขที่บัตรประจําตัวประชาชน / หากเป็นคนต่างด้าว โปรดระบุเลขที่หนังสือเดินทาง หรือเอกสารประจําตัวอื่นๆ",
             "请填写身份证号 / 如为外籍请填护照号或其他身份证件号"),
         ]),
        ("ส่วนที่ ๓. ข้อเท็จจริงเกี่ยวกับธุรกรรม",
         [
            ("วันที่ทําธุรกรรม ____ เดือน ____ พ.ศ.____",
             "交易日期：____月____日，佛历____年"),
            ("๓.๑ ประเภทและมูลค่าธุรกรรม（จํานวนเป็นบาท และจำนวนเงินเป็นตัวอักษร）",
             "3.1 交易类型与金额（以泰铢计，并填写大写金额）"),
            ("— ด้านรับเงิน (เงินเข้าบัญชี)：ฝากเงิน；ซื้อตราสารการเงิน（เช็ค、ดราฟต์、อื่นๆ）；ซื้อเงินตราต่างประเทศ（ระบุสกุลเงิน）；อื่นๆ（ระบุ）。เข้าบัญชีเลขที่ ____；บัญชีที่เกี่ยวข้อง (หากมี)",
             "— 收入方（入账）：存款；购买金融票据（支票、银行汇票、其他）；购买外币（注明币种）；其他（注明）。入账账号：____；相关账户（如有）"),
            ("— ด้านจ่ายเงิน (เงินออกบัญชี)：ถอนเงิน；ขายตราสารการเงิน（เช็ค、ดราฟต์、อื่นๆ）；ขายเงินตราต่างประเทศ（ระบุสกุลเงิน）；อื่นๆ（ระบุ）。จากบัญชีเลขที่ ____；บัญชีที่เกี่ยวข้อง (หากมี)",
             "— 支出方（出账）：取现；出售金融票据（支票、银行汇票、其他）；出售外币（注明币种）；其他（注明）。出账账号：____；相关账户（如有）"),
            ("๓.๒ ชื่อผู้รับประโยชน์ (ถ้ามี)",
             "3.2 受益人姓名（如有）"),
            ("๓.๓ วัตถุประสงค์ในการทําธุรกรรม",
             "3.3 交易目的"),
         ]),
        ("ส่วนที่ ๔. ลายมือชื่อ",
         [
            ("สถาบันการเงินเป็นผู้บันทึกข้อเท็จจริง (วัน/เดือน/ปีที่บันทึกข้อเท็จจริง)；ลูกค้าไม่ลงลายมือชื่อ",
             "由金融机构记录事实（记录日期）；客户未签名"),
            ("ลายมือชื่อผู้ทําธุรกรรมหรือผู้บันทึกข้อเท็จจริง；ลายมือชื่อผู้รายงาน；(วัน/เดือน/ปีที่รายงาน)",
             "交易人或事实记录人签名；报告人签名；（报告日期）"),
         ]),
        ("คําอธิบาย / 說明",
         [
            ("ธุรกรรมที่ใช้เงินสด: กิจกรรมที่เกี่ยวกับสถาบันการเงินซึ่งกระทําโดยใช้เงินสด",
             "“现金交易”：与金融机构办理、以现金进行的各类行为"),
            ("เงินสด: ธนบัตรและเหรียญกษาปณ์ที่ชําระหนี้ได้ตามกฎหมาย",
             "“现金”：依法可用于清偿债务的纸币和硬币"),
            ("ผู้ทําธุรกรรม: บุคคลที่มาทําธุรกรรมกับสถาบันการเงิน",
             "“交易人”：与金融机构办理业务的个人"),
            ("ผู้มอบหมาย/ผู้มอบอํานาจ: 受托/授权他人代办交易之人（法人需加盖公章并由有权人签名）",
             "“委托人/授权人”：授权他人代办交易之人（法人须由授权签字人签名并加盖公章）"),
            ("ผู้รายงาน: เจ้าหน้าที่ของสถาบันการเงินผู้รับทําธุรกรรม",
             "“报告人”：办理该交易的金融机构工作人员"),
            ("วิธีกรอก (สรุป): 现金额自“2,000,000泰铢及以上”须填报；空间不足可另附A4并在“附件总计”栏注明数量；按第1至第4部分逐项填写。",
             "填表说明（摘要）：现金交易自“2,000,000泰铢及以上”须申报；如空间不足，请另附A4并在“附件总计”栏注明页数；按第1–4部分逐项填写。"),
            ("หมายเหตุ: 依《反洗钱法》条款，善意报告致他人损害者不承担赔偿；虚假或隐瞒事实者可处监禁不超过2年或罚款5–50万泰铢，或两者并罚。",
             "注：依据相关《反洗钱法》条款，善意申报免于赔偿；虚假申报或隐瞒事实将被追责。"),
         ]),
    ]
    return th_title, zh_title, sections

def build_sections_1_02():
    th_title = "แบบรายงานการทําธุรกรรมที่เกี่ยวกับทรัพย์สิน (แบบ ปปง. ๑-๐๒)"
    zh_title = "资产相关交易报告表（表格编号：ปปง. 1-02）"
    sections = [
        ("ข้อมูลส่วนหัว / Header",
         [
            ("รายงานฉบับหลัก / รายงานฉบับแก้ไข/เพิ่มเติม ครั้งที่___ ลงวันที่___",
             "主报告 / 更正/补充报告 第___次，日期___"),
            ("เลขที่ ________  สถาบันการเงิน ________  สาขา ________  พ.ศ. ________  เลขลําดับรายงาน (ใช้ 2 หลักสุดท้าย) ________",
             "编号______  金融机构______  网点______  佛历年份______  报告顺序号（取后2位）______"),
            ("รวมเอกสารจํานวนทั้งสิ้น ______ แผ่น",
             "附件总计 ______ 页"),
         ]),
        ("ส่วนที่ ๑. ผู้ทําธุรกรรม",
         [
            ("๑.๑ ชื่อ-นามสกุล；ทําธุรกรรมด้วยตนเอง / ทําธุรกรรมแทนผู้อื่น (รายละเอียดโปรดกรอกในส่วนที่ ๒)",
             "1.1 姓名；自行办理 / 代他人办理（详情请填写第2部分）"),
            ("๑.๒ ที่อยู่；โทรศัพท์；โทรสาร",
             "1.2 地址；电话；传真"),
            ("๑.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์",
             "1.3 职业；工作单位；电话"),
            ("๑.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "1.4 方便联系地址；电话；传真"),
            ("๑.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、อื่นๆ（โปรดระบุ）。เลขที่、ออกโดย、เมื่อ、หมดอายุ",
             "1.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、其他（请注明）。编号、签发机关、签发日期、到期日"),
         ]),
        ("ส่วนที่ ๒. ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
         [
            ("โปรดระบุฐานะ: ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
             "请选择身份：共同交易人 / 委托人 / 授权人"),
            ("๒.๑ ชื่อ",
             "2.1 姓名 / 名称"),
            ("๒.๒ ที่อยู่/สถานที่ตั้ง；โทรศัพท์；โทรสาร",
             "2.2 地址/所在地；电话；传真"),
            ("๒.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์ (กรณีเป็นนิติบุคคล ระบุประเภทกิจการ)",
             "2.3 职业；工作单位；电话（如为法人，请注明经营类型）"),
            ("๒.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "2.4 方便联系地址；电话；传真"),
            ("๒.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、หนังสือรับรองทะเบียน (ไม่เกิน 1 เดือน)、อื่นๆ（โปรดระบุ）。เลขที่、ออกโดย、เมื่อ、หมดอายุ",
             "2.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、登记信息证明（登记官出具，日期不超过1个月）、其他（请注明）。编号、签发机关、签发日期、到期日"),
         ]),
        ("ส่วนที่ ๓. ข้อเท็จจริงเกี่ยวกับธุรกรรม",
         [
            ("วันที่ทําธุรกรรม ____ เดือน ____ พ.ศ.____",
             "交易日期：____月____日，佛历____年"),
            ("๓.๑ ประเภทธุรกรรม：จํานอง / ขายฝาก / โอนเงิน / อื่นๆ（ระบุ）",
             "3.1 交易类型：抵押 / 附回赎权买卖（售后回购）/ 转移款项 / 其他（注明）"),
            ("๓.๒ ประเภททรัพย์สิน：ที่ดิน / ที่ดินและสิ่งปลูกสร้าง / สิ่งปลูกสร้าง / อื่นๆ（ระบุ）；โปรดระบุรายละเอียดของทรัพย์สิน",
             "3.2 资产类型：土地 / 土地及建筑物 / 建筑物 / 其他（注明）；请填写资产详情"),
            ("๓.๓ มูลค่าทรัพย์สินรวมทั้งสิ้น (บาท) （หากเป็นเงินตราต่างประเทศ โปรดระบุจำนวนและสกุลเงิน）",
             "3.3 资产交易总额（泰铢）；如为外币，请注明金额与币种"),
            ("๓.๔ เลขที่บัญชีที่ทําธุรกรรม — ชื่อบัญชี / ชื่อเจ้าของบัญชี",
             "3.4 交易账户号 — 账户名 / 账户所有者"),
            ("๓.๕ บัญชีที่เกี่ยวข้อง (หากมี) — ชื่อบัญชี / ชื่อเจ้าของบัญชี / เกี่ยวข้องโดย",
             "3.5 相关账户（如有）— 账户名 / 账户所有者 / 关联关系"),
            ("๓.๖ ชื่อผู้รับประโยชน์ (ถ้ามี)；๓.๗ วัตถุประสงค์ในการทําธุรกรรม",
             "3.6 受益人姓名（如有）；3.7 交易目的"),
         ]),
        ("ส่วนที่ ๔. ลายมือชื่อ",
         [
            ("สถาบันการเงินเป็นผู้บันทึกข้อเท็จจริง (วัน/เดือน/ปีที่บันทึกข้อเท็จจริง)；ลูกค้าไม่ลงลายมือชื่อ",
             "由金融机构记录事实（记录日期）；客户未签名"),
            ("ลายมือชื่อผู้ทําธุรกรรมหรือผู้บันทึกข้อเท็จจริง；ลายมือชื่อผู้รายงาน；(วัน/เดือน/ปีที่รายงาน)",
             "交易人或事实记录人签名；报告人签名；（报告日期）"),
         ]),
        ("คําอธิบาย / 說明",
         [
            ("ธุรกรรมที่เกี่ยวกับทรัพย์สิน: ใช้ทรัพย์สินประกอบนิติกรรม/สัญญาหรือดําเนินการกับสถาบันการเงิน",
             "“与资产相关的交易”：以资产作为法律行为/契约或与金融机构办理相关之交易"),
            ("ทรัพย์สิน: สังหาริมทรัพย์และอสังหาริมทรัพย์",
             "“资产”：动产与不动产"),
            ("วิธีกรอก (สรุป): มูลค่าตั้งแต่ ๕ ล้านบาทขึ้นไป ต้องกรอกแบบรายงาน；空间不足可另附A4并在“附件总计”栏注明数量。",
             "填表说明（摘要）：交易金额自5,000,000泰铢起需申报；空间不足请另附A4并在“附件总计”栏注明页数。"),
            ("หมายเหตุ: 依《反洗钱法》条款，对善意申报者予以免责；虚假或隐瞒事实者将被追责。",
             "注：依据相关《反洗钱法》条款，善意申报免于赔偿；虚假申报或隐瞒事实将被追责。"),
         ]),
    ]
    return th_title, zh_title, sections

def build_sections_1_03():
    th_title = "แบบรายงานการทําธุรกรรมที่มีเหตุอันควรสงสัย (แบบ ปปง. ๑-๐๓)"
    zh_title = "可疑交易报告表（表格编号：ปปง. 1-03）"
    sections = [
        ("ข้อมูลส่วนหัว / Header",
         [
            ("รายงานฉบับหลัก / รายงานแก้ไข/เพิ่มเติม ครั้งที่___ ลงวันที่___",
             "主报告 / 更正/补充报告 第___次，日期___"),
            ("เลขที่ ________  สถาบันการเงิน ________  สาขา ________  พ.ศ. ________  เลขลําดับรายงาน (ใช้ 2 หลักสุดท้าย) ________",
             "编号______  金融机构______  网点______  佛历年份______  报告顺序号（取后2位）______"),
            ("รวมเอกสารจํานวนทั้งสิ้น ______ แผ่น",
             "附件总计 ______ 页"),
         ]),
        ("ส่วนที่ ๑. ผู้ทําธุรกรรม",
         [
            ("๑.๑ ชื่อ-นามสกุล；ทําธุรกรรมด้วยตนเอง / ทําธุรกรรมแทนผู้อื่น",
             "1.1 姓名；自行办理 / 代他人办理"),
            ("๑.๒ ที่อยู่；โทรศัพท์；โทรสาร",
             "1.2 地址；电话；传真"),
            ("๑.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์",
             "1.3 职业；工作单位；电话"),
            ("๑.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "1.4 方便联系地址；电话；传真"),
            ("๑.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、อื่นๆ（โปรดระบุ）。เลขที่、ออกโดย、เมื่อ、หมดอายุ",
             "1.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、其他（请注明）。编号、签发机关、签发日期、到期日"),
        ]),
        ("ส่วนที่ ๒. ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
         [
            ("โปรดระบุฐานะ: ผู้ร่วมทําธุรกรรม / ผู้มอบหมาย / ผู้มอบอํานาจ",
             "请选择身份：共同交易人 / 委托人 / 授权人"),
            ("๒.๑ ชื่อ；๒.๒ ที่อยู่/สถานที่ตั้ง；โทรศัพท์；โทรสาร",
             "2.1 姓名 / 名称；2.2 地址/所在地；电话；传真"),
            ("๒.๓ อาชีพ；สถานที่ทํางาน；โทรศัพท์（กรณีเป็นนิติบุคคล ระบุประเภทกิจการ）",
             "2.3 职业；工作单位；电话（如为法人，请注明经营类型）"),
            ("๒.๔ สถานที่สะดวกในการติดต่อ；โทรศัพท์；โทรสาร",
             "2.4 方便联系地址；电话；传真"),
            ("๒.๕ หลักฐานที่ใช้ในการทําธุรกรรม：บัตรประชาชน/ข้าราชการ/พนักงานรัฐวิสาหกิจ、หนังสือเดินทาง、ใบสําคัญประจําตัวคนต่างด้าว、หนังสือรับรองทะเบียน (ไม่เกิน 1 เดือน)、อื่นๆ（โปรดระบุ）",
             "2.5 交易凭证：身份证/公务员证/国企员工证、护照、外侨身份证、登记信息证明（登记官出具，不超过1个月）、其他（请注明）"),
        ]),
        ("ส่วนที่ ๓. ข้อเท็จจริงเกี่ยวกับธุรกรรม",
         [
            ("วันที่ทําธุรกรรม ____ เดือน ____ พ.ศ.____",
             "交易日期：____月____日，佛历____年"),
            ("๓.๑ มูลค่าของธุรกรรม (บาท)（จำนวนเงินเป็นตัวอักษร）",
             "3.1 交易金额（泰铢）（并填写大写金额）"),
            ("๓.๒ ประเภทธุรกรรม：ธุรกรรมที่ใช้เงินสด（โปรดระบุ）/ ธุรกรรมเกี่ยวกับทรัพย์สิน（โปรดระบุ）",
             "3.2 交易类型：现金交易（请注明）/ 资产相关交易（请注明）"),
            ("๓.๓ เลขที่บัญชีที่ทําธุรกรรม；๓.๔ บัญชีที่เกี่ยวข้อง (หากมี)；๓.๕ ชื่อผู้รับประโยชน์ (ถ้ามี)；๓.๖ วัตถุประสงค์ในการทําธุรกรรม",
             "3.3 涉及的账户号；3.4 相关账户（如有）；3.5 受益人（如有）；3.6 交易目的"),
         ]),
        ("ส่วนที่ ๔–๖ ลายมือชื่อและเหตุอันควรสงสัย",
         [
            ("ส่วนนี ้ให้ผู้บันทึกข้อเท็จจริงลงลายมือชื่อ（วัน/เดือน/ปีที่บันทึกข้อเท็จจริง），และให้ผู้รายงานลงลายมือชื่อ（วัน/เดือน/ปีที่รายงาน）",
             "本部分由事实记录人签名（记录日期），并由报告人签名（报告日期）"),
            ("ส่วนที่ ๕ เหตุอันควรสงสัย：โปรดบรรยายเหตุผลอย่างละเอียด",
             "第5部分 可疑原因：请详细说明可疑之处"),
         ]),
        ("คําอธิบาย / 說明",
         [
            ("ธุรกรรมที่มีเหตุอันควรสงสัย: ลักษณะที่ซับซ้อน ผิดปกติ ขาดความเป็นไปได้ทางเศรษฐกิจ หรือมีเหตุหลีกเลี่ยงกฎหมาย/เกี่ยวกับความผิดมูลฐาน",
             "“可疑交易”：复杂异常、缺乏经济合理性、疑似规避法律或与上游犯罪相关的交易"),
            ("หากธุรกรรมดังกล่าวได้รายงานไว้แล้วในฐานะ “เงินสด/ทรัพย์สิน” ให้ระบุเลขที่รายงานฉบับหลัก และในเอกสารฉบับนี้กรอกเฉพาะส่วนที่ ๕ (เหตุอันควรสงสัย)",
             "若该交易已作为“现金/资产”报送过，请在此注明主报告编号，并本表仅填写第5部分（可疑原因）"),
            ("หมายเหตุ: 善意申报免于赔偿；虚假或隐瞒事实将被追责。",
             "注：善意申报免责；虚假或隐瞒事实依法追责。"),
         ]),
    ]
    return th_title, zh_title, sections


# Try to import python-docx; if unavailable, fallback to RTF.
try:
    from docx import Document
    from docx.shared import Cm, Pt
    from docx.enum.text import WD_ALIGN_PARAGRAPH
    from docx.oxml.ns import qn
    DOCX_AVAILABLE = True
except Exception as e:
    DOCX_AVAILABLE = False
    DOCX_IMPORT_ERROR = str(e)


def create_docx(path, th_title, zh_title, sections):
    doc = Document()
    # Page setup (A4)
    section = doc.sections[0]
    section.page_width = Cm(21.0)
    section.page_height = Cm(29.7)
    section.left_margin = Cm(2.0)
    section.right_margin = Cm(2.0)
    section.top_margin = Cm(2.0)
    section.bottom_margin = Cm(2.0)

    # Title
    p = doc.add_paragraph()
    run = p.add_run(th_title + "\n" + zh_title)
    try:
        run.font.name = "Microsoft YaHei"
        run._element.rPr.rFonts.set(qn('w:eastAsia'), "Microsoft YaHei")
    except Exception:
        pass
    run.bold = True
    run.font.size = Pt(14)
    p.alignment = WD_ALIGN_PARAGRAPH.CENTER

    subtitle = doc.add_paragraph("（原文—中文对照；按原表单的区块与字段顺序排列）")
    subtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER

    # Build sections
    for sec_title, rows in sections:
        h = doc.add_paragraph()
        r = h.add_run(sec_title)
        r.bold = True
        r.font.size = Pt(12)

        # Table: two columns (Thai | Chinese)
        table = doc.add_table(rows=len(rows)+1, cols=2)
        table.style = "Table Grid"
        # header row
        hdr = table.rows[0].cells
        hdr[0].text = "原文（泰文）"
        hdr[1].text = "中文翻译"
        for i, (th, zh) in enumerate(rows, start=1):
            table.cell(i, 0).text = th
            table.cell(i, 1).text = zh

        # spacing
        doc.add_paragraph()

    doc.save(path)


def create_rtf(path, th_title, zh_title, sections):
    # Minimal RTF with bilingual content; simpler layout: headings + Thai then Chinese lines.
    # Word opens RTF fine.
    def esc(t):
        return t.replace("\\", "\\\\").replace("{", "\\{").replace("}", "\\}")
    parts = []
    parts.append(r"{\rtf1\ansi\deff0")
    # Title
    parts.append(r"\fs28\b " + esc(th_title) + r"\line " + esc(zh_title) + r"\b0\fs22\line ")
    parts.append(esc("（原文—中文对照；按原表单的区块与字段顺序排列）") + r"\line\line ")
    # Sections
    for sec_title, rows in sections:
        parts.append(r"\b " + esc(sec_title) + r"\b0\line ")
        for th, zh in rows:
            parts.append(r"\i " + esc(th) + r"\i0\line ")
            parts.append(esc(zh) + r"\line\line ")
        parts.append(r"\line ")
    parts.append("}")
    with open(path, "w", encoding="utf-8") as f:
        f.write("".join(parts))

# Build content
docs_info = [
    ("AML-1-01-bilingual",) + build_sections_1_01(),
    ("AML-1-02-bilingual",) + build_sections_1_02(),
    ("AML-1-03-bilingual",) + build_sections_1_03(),
]

created_files = []

for base, th_title, zh_title, sections in docs_info:
    if DOCX_AVAILABLE:
        path = f"/mnt/data/{base}.docx"
        create_docx(path, th_title, zh_title, sections)
        created_files.append(path)
    else:
        path = f"/mnt/data/{base}.rtf"
        create_rtf(path, th_title, zh_title, sections)
        created_files.append(path)

# Report what we created so the chat response can link them
created_files
