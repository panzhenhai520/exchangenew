<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­éŸ³åŠŸèƒ½æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .test-section h3 {
            margin-top: 0;
            color: #555;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .voice-info {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .voice-item {
            margin: 5px 0;
            padding: 5px;
            background-color: white;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”Š è¯­éŸ³åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
        
        <div class="test-section">
            <h3>1. è¯­éŸ³åˆæˆæ”¯æŒæ£€æŸ¥</h3>
            <button onclick="testSpeechSynthesisSupport()">æ£€æŸ¥è¯­éŸ³åˆæˆæ”¯æŒ</button>
            <div id="support-status" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>2. å¯ç”¨è¯­éŸ³æ£€æŸ¥</h3>
            <button onclick="testAvailableVoices()">æ£€æŸ¥å¯ç”¨è¯­éŸ³</button>
            <div id="voices-status" class="status"></div>
            <div id="voices-info" class="voice-info"></div>
        </div>
        
        <div class="test-section">
            <h3>3. åŸºæœ¬è¯­éŸ³æ’­æŠ¥æµ‹è¯•</h3>
            <button onclick="testBasicSpeech()">æµ‹è¯•ä¸­æ–‡è¯­éŸ³</button>
            <button onclick="testEnglishSpeech()">æµ‹è¯•è‹±æ–‡è¯­éŸ³</button>
            <button onclick="testThaiSpeech()">æµ‹è¯•æ³°æ–‡è¯­éŸ³</button>
            <div id="basic-speech-status" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>4. è¯­éŸ³çŠ¶æ€æ£€æŸ¥</h3>
            <button onclick="checkSpeechStatus()">æ£€æŸ¥è¯­éŸ³çŠ¶æ€</button>
            <div id="status-info" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>5. å®Œæ•´æµ‹è¯•</h3>
            <button onclick="runCompleteTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
            <div id="complete-test-status" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>6. æ§åˆ¶å°æ—¥å¿—</h3>
            <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <div id="log-output" class="log"></div>
        </div>
    </div>

    <script>
        // é‡å®šå‘æ§åˆ¶å°è¾“å‡ºåˆ°é¡µé¢
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToLog(message, type = 'log') {
            const logOutput = document.getElementById('log-output');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            logOutput.textContent += logEntry;
            logOutput.scrollTop = logOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLog(args.join(' '), 'warn');
        };
        
        function clearLog() {
            document.getElementById('log-output').textContent = '';
        }
        
        function updateStatus(elementId, message, type = 'success') {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }
        
        // 1. æ£€æŸ¥è¯­éŸ³åˆæˆæ”¯æŒ
        function testSpeechSynthesisSupport() {
            console.log('ğŸ”Š æ£€æŸ¥è¯­éŸ³åˆæˆæ”¯æŒ...');
            
            if ('speechSynthesis' in window) {
                const speechSynthesis = window.speechSynthesis;
                
                let statusMessage = 'âœ… æµè§ˆå™¨æ”¯æŒè¯­éŸ³åˆæˆ API\n';
                
                if (typeof speechSynthesis.speak === 'function') {
                    statusMessage += 'âœ… speak æ–¹æ³•å¯ç”¨\n';
                } else {
                    statusMessage += 'âŒ speak æ–¹æ³•ä¸å¯ç”¨\n';
                }
                
                if (typeof speechSynthesis.cancel === 'function') {
                    statusMessage += 'âœ… cancel æ–¹æ³•å¯ç”¨\n';
                } else {
                    statusMessage += 'âŒ cancel æ–¹æ³•ä¸å¯ç”¨\n';
                }
                
                if (typeof speechSynthesis.getVoices === 'function') {
                    statusMessage += 'âœ… getVoices æ–¹æ³•å¯ç”¨';
                } else {
                    statusMessage += 'âŒ getVoices æ–¹æ³•ä¸å¯ç”¨';
                }
                
                updateStatus('support-status', statusMessage, 'success');
            } else {
                updateStatus('support-status', 'âŒ æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ API', 'error');
            }
        }
        
        // 2. æ£€æŸ¥å¯ç”¨è¯­éŸ³
        function testAvailableVoices() {
            console.log('ğŸ”Š æ£€æŸ¥å¯ç”¨è¯­éŸ³...');
            
            const speechSynthesis = window.speechSynthesis;
            const voices = speechSynthesis.getVoices();
            
            let statusMessage = `ğŸ”Š å¯ç”¨è¯­éŸ³æ•°é‡: ${voices.length}\n`;
            
            if (voices.length === 0) {
                statusMessage += 'âš ï¸ æ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„è¯­éŸ³ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…è¯­éŸ³åŠ è½½';
                updateStatus('voices-status', statusMessage, 'warning');
                
                // å°è¯•ç­‰å¾…è¯­éŸ³åŠ è½½
                speechSynthesis.onvoiceschanged = () => {
                    const loadedVoices = speechSynthesis.getVoices();
                    displayVoicesInfo(loadedVoices);
                };
                
                speechSynthesis.getVoices();
            } else {
                displayVoicesInfo(voices);
            }
        }
        
        function displayVoicesInfo(voices) {
            const supportedLanguages = [...new Set(voices.map(voice => voice.lang.split('-')[0]))];
            const chineseVoices = voices.filter(voice => voice.lang.startsWith('zh'));
            const englishVoices = voices.filter(voice => voice.lang.startsWith('en'));
            
            let statusMessage = `âœ… æ‰¾åˆ° ${voices.length} ä¸ªå¯ç”¨è¯­éŸ³\n`;
            statusMessage += `ğŸ”Š æ”¯æŒçš„è¯­éŸ³è¯­è¨€: ${supportedLanguages.join(', ')}\n`;
            statusMessage += `ğŸ”Š ä¸­æ–‡è¯­éŸ³æ•°é‡: ${chineseVoices.length}\n`;
            statusMessage += `ğŸ”Š è‹±æ–‡è¯­éŸ³æ•°é‡: ${englishVoices.length}`;
            
            updateStatus('voices-status', statusMessage, 'success');
            
            // æ˜¾ç¤ºè¯­éŸ³è¯¦æƒ…
            const voicesInfo = document.getElementById('voices-info');
            voicesInfo.innerHTML = `
                <h4>ä¸­æ–‡è¯­éŸ³:</h4>
                ${chineseVoices.map(v => `<div class="voice-item">${v.name} (${v.lang})</div>`).join('')}
                <h4>è‹±æ–‡è¯­éŸ³:</h4>
                ${englishVoices.map(v => `<div class="voice-item">${v.name} (${v.lang})</div>`).join('')}
            `;
        }
        
        // 3. åŸºæœ¬è¯­éŸ³æ’­æŠ¥æµ‹è¯•
        function testBasicSpeech() {
            testSpeechUtterance('æµ‹è¯•ä¸­æ–‡è¯­éŸ³æ’­æŠ¥åŠŸèƒ½ï¼Œå¦‚æœæ‚¨å¬åˆ°è¿™å¥è¯ï¼Œè¯´æ˜è¯­éŸ³æ’­æŠ¥åŠŸèƒ½æ­£å¸¸');
            updateStatus('basic-speech-status', 'ğŸ”Š æ­£åœ¨æ’­æ”¾ä¸­æ–‡è¯­éŸ³æµ‹è¯•...', 'success');
        }
        
        function testEnglishSpeech() {
            testSpeechUtterance('Test English speech synthesis. If you can hear this, the speech function is working properly.', 'en-US');
            updateStatus('basic-speech-status', 'ğŸ”Š æ­£åœ¨æ’­æ”¾è‹±æ–‡è¯­éŸ³æµ‹è¯•...', 'success');
        }
        
        function testThaiSpeech() {
            testSpeechUtterance('à¸—à¸”à¸ªà¸­à¸šà¸à¸²à¸£à¸à¸¹à¸”à¸ à¸²à¸©à¸²à¹„à¸—à¸¢ à¸«à¸²à¸à¸„à¸¸à¸“à¹„à¸”à¹‰à¸¢à¸´à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸™à¸µà¹‰ à¹à¸ªà¸”à¸‡à¸§à¹ˆà¸²à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸à¸²à¸£à¸à¸¹à¸”à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸›à¸à¸•à¸´', 'th-TH');
            updateStatus('basic-speech-status', 'ğŸ”Š æ­£åœ¨æ’­æ”¾æ³°æ–‡è¯­éŸ³æµ‹è¯•...', 'success');
        }
        
        function testSpeechUtterance(text, lang = 'zh-CN') {
            try {
                const speechSynthesis = window.speechSynthesis;
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance();
                utterance.text = text;
                utterance.lang = lang;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                
                utterance.onstart = () => {
                    console.log('âœ… è¯­éŸ³æ’­æŠ¥å¼€å§‹');
                    updateStatus('basic-speech-status', 'âœ… è¯­éŸ³æ’­æŠ¥å¼€å§‹', 'success');
                };
                
                utterance.onend = () => {
                    console.log('âœ… è¯­éŸ³æ’­æŠ¥ç»“æŸ');
                    updateStatus('basic-speech-status', 'âœ… è¯­éŸ³æ’­æŠ¥ç»“æŸ', 'success');
                };
                
                utterance.onerror = (event) => {
                    console.error('âŒ è¯­éŸ³æ’­æŠ¥é”™è¯¯:', event.error);
                    updateStatus('basic-speech-status', `âŒ è¯­éŸ³æ’­æŠ¥é”™è¯¯: ${event.error}`, 'error');
                };
                
                speechSynthesis.speak(utterance);
                
            } catch (error) {
                console.error('âŒ è¯­éŸ³æ’­æŠ¥æµ‹è¯•å¤±è´¥:', error);
                updateStatus('basic-speech-status', `âŒ è¯­éŸ³æ’­æŠ¥æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // 4. æ£€æŸ¥è¯­éŸ³çŠ¶æ€
        function checkSpeechStatus() {
            const speechSynthesis = window.speechSynthesis;
            
            const status = {
                speaking: speechSynthesis.speaking,
                pending: speechSynthesis.pending,
                paused: speechSynthesis.paused
            };
            
            let statusMessage = `ğŸ”Š è¯­éŸ³åˆæˆçŠ¶æ€:\n`;
            statusMessage += `æ­£åœ¨æ’­æ”¾: ${status.speaking ? 'æ˜¯' : 'å¦'}\n`;
            statusMessage += `æœ‰å¾…æ’­æ”¾: ${status.pending ? 'æ˜¯' : 'å¦'}\n`;
            statusMessage += `å·²æš‚åœ: ${status.paused ? 'æ˜¯' : 'å¦'}`;
            
            updateStatus('status-info', statusMessage, 'success');
        }
        
        // 5. å®Œæ•´æµ‹è¯•
        function runCompleteTest() {
            console.log('ğŸ”Š ===== å¼€å§‹å®Œæ•´è¯­éŸ³åŠŸèƒ½æµ‹è¯• =====');
            updateStatus('complete-test-status', 'ğŸ”Š å¼€å§‹å®Œæ•´æµ‹è¯•...', 'success');
            
            // æ£€æŸ¥æ”¯æŒ
            testSpeechSynthesisSupport();
            
            // æ£€æŸ¥è¯­éŸ³
            setTimeout(() => {
                testAvailableVoices();
            }, 1000);
            
            // æµ‹è¯•è¯­éŸ³æ’­æŠ¥
            setTimeout(() => {
                testBasicSpeech();
            }, 2000);
            
            // æ£€æŸ¥çŠ¶æ€
            setTimeout(() => {
                checkSpeechStatus();
                updateStatus('complete-test-status', 'âœ… å®Œæ•´æµ‹è¯•å®Œæˆ', 'success');
            }, 5000);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡ŒåŸºæœ¬æ£€æŸ¥
        window.onload = function() {
            console.log('ğŸ”Š è¯­éŸ³åŠŸèƒ½æµ‹è¯•é¡µé¢å·²åŠ è½½');
            testSpeechSynthesisSupport();
        };
    </script>
</body>
</html> 